# 목표

자바의 멀티쓰레드 프로그래밍에 대해 학습하세요.

# 학습할 것 (필수)

- Thread 클래스와 Runnable 인터페이스
- 쓰레드의 상태
- 쓰레드의 우선순위
- Main 쓰레드
- 동기화
- 데드락



### 프로세스(Process)

 

- 사전적 의미 : 일의 과정이나 공정
- 실행중인 프로그램을 의미
- 프로그램을 실행하면 OS로부터 실행에 필요한 자원(메모리)을 할당받아 프로세스가 됨

 

### 쓰레드(Thread)

- 프로세스라는 작업공간에서 실제로 작업을 처리하는 일꾼
- 프로세스의 자원을 이용해서 작업을 수행함
- 모든 프로세스에는 최소한 하나 이상의 쓰레드가 존재
- 쓰레드가 하나(싱글 쓰레드)
- 둘 이상의 쓰레드(멀티 쓰레드)



## Process vs Thread

- process
  - 프로그램의 인스턴스, 실행된 프로그램
  - 이미 메모리에 적재되어 있음
- thread
  - 한 프로세스 내에서 동시에 실행 가능한 단위
  - stack 공유(복제되어 가짐)
  - Java 에서는 JVM 이 모든 thread 관리

### 멀티 프로세스와 멀티 스레드의 비교

멀티프로세스와 멀티스레드는 양쪽 모두 **여러 흐름이 동시에 진행된다는 공통점**을 가지고 있다.

하지만, **멀티프로세스**에서 각 프로세스는 **독립적으로 실행되며 각각 별개의 메모리를 차지**하고 있는 것과 달리 **멀티스레드는 프로세스 내의 메모리를 공유해 사용할 수 있다.**

또한, 프로세스 간의 전환 속도보다 스레드간의 전환속도가 빠르다.

**`멀티스레드의 장점`**은 CPU가 여러 개일 경우 각각의 CPU 스레드 하나씩을 담당하는 방법으로 속도를 높일 수 있다. 이러한 시스템에서는 여러 스레드가 실제 시간상으로 동시에 실행될 수 있다.

그러나 **`단점`**은 각각의 스레드 중 어떤 것이 먼저 실행될지 그 순서를 알 수 없다는 것이다.



### 멀티 태스킹(multi-tasking)

- 여러 개의 프로세스가 동시에 실행될 수 있는것을 말한다
- 대부분의 OS가 지원한다

 

### 멀티 쓰레딩(multi-threading) 

하나의 프로세스 내에서 여러 쓰레드가 동시에 작업을 수행하는 것. CPU의 코어(core)가 한 번에 단 하나의 작업만 수행할 수 있으므로, 실제로 동시에 처리되는 작업의 개수와 일치한다.

* 대부분 쓰레드의 수는 코어의 개수보다 훨씬 많기 때문에 각 코어가 아주 짧은 시간 동안 여러 작업을 번갈아 가며 수행함으로써 여러 작업들이 모두 동시에 수행되는 것처럼 보이게한다.
* 따라서 프로세스의 성능이 단순하게 쓰레드의 개수에 비례하는것은 아니며, 하나의 쓰레드를 가진 프로세스보다 두개의 쓰레드를 가진 프로세스가 오히려 더 낮은 성능을 보일 수 있습니다.

 

### 멀티 쓰레딩의 장점

- CPU의 사용률을 향상시킨다
- 자원을 보다 효율적으로 사용할 수 있다
- 사용자에 대한 응답성이 
- 작업이 분리되어 코드가 간결해진다.



### 멀티 쓰레딩에서 주의할 점(신경써야 할 점?)

 여러 쓰레드가 같은 프로세스 내에서 자원을 공유하면서 작업을 하기 때문에 발생할 수 있는 동기화(synchronization), 교착상태(deadlock) 과 같은 문제들을 고려해서 신중히 프로그래밍 해야한다.



### 동시성(concurrency)과 병렬성(parallelism)

멀티 쓰레드가 실행될 때 이 두가지 중 하나로 실행된다.

이것은 CPU의 코어의 수와도 연관이 있는데,

하나의 코에서 여러 쓰레드가 실행되는 것을 `**"동시성"**`

멀티 코어를 사용할 때 코어별로 개별 쓰레드가 실행되는 것을 `"병렬성"`

만약 코어의 수가 쓰레드의 수보다 많다면, 병렬성으로 쓰레드를 실행하면 되는데, **코어의 수보다 쓰레드의 수가 더 많을 경우 "동시성"을 고려하지 않을 수 없다.**

###  **`동시성을 고려 한다는 것은`** 하나의 코어에서 여러 쓰레드를 실행할 때 병렬로 실행하는 것처럼 보이지만, 사실은 병렬로 처리하지 못하고 한 수간에는 하나의 쓰레드만 처리할 수 있어서 번갈아 가며 처리하게 된다.



- **동시성(concurrency)**은 어떻게 보면 동시에 하는 것이 아니다, 내부적으로 번갈아가며 진행하는 것이다.

  (context switching이 지속적으로 발생한다.)

  

# Thread 클래스와 Runnable 인터페이스





# 쓰레드의 상태





# 쓰레드의 우선순위





# Main 쓰레드





# 동기화





# 데드락